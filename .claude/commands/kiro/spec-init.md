---
description: 詳細なプロジェクト説明と要件を含む新しい仕様を初期化
allowed-tools: Bash, Read, Write, Glob
---

# 仕様初期化

提供されたプロジェクト説明に基づいて新しい仕様を初期化:

プロジェクト説明: $ARGUMENTS

## ステアリングコンテキスト検証

### ステアリングドキュメントの確認
- 構造コンテキスト: @.kiro/steering/structure.md
- 技術的制約: @.kiro/steering/tech.md  
- プロダクトコンテキスト: @.kiro/steering/product.md

### ステアリングの存在確認
- ステアリングファイル: !`[ -d .kiro/steering ] && ls -la .kiro/steering/ || echo "ステアリングディレクトリが見つかりません - ステアリングコンテキストなしで続行"`

柔軟性: 新機能や空のプロジェクトの場合、ステアリングドキュメントは推奨されますが必須ではありません。ステアリングドキュメントが欠落または空の場合、仕様生成フェーズに直接進むことができます。

## タスク: 仕様構造の初期化

スコープ: このコマンドは、提供された詳細なプロジェクト説明に基づいてディレクトリ構造とメタデータを初期化します。

### 1. プロジェクト説明の分析
提供された説明（$ARGUMENTS）から以下を抽出:
- プロジェクトの目的と目標
- 主要な機能と機能性
- ターゲットユーザーまたはユースケース
- 技術的要件または制約
- 言及された特定の実装詳細

### 2. 機能名の生成
分析に基づいて、プロジェクトの本質を捉えた簡潔で説明的な機能名を作成。

### 3. 仕様ディレクトリの作成
`.kiro/specs/{生成された機能名}/` ディレクトリをテンプレートファイルと共に作成:
- `requirements.md` - ユーザーストーリー用の空のテンプレート
- `design.md` - 技術設計用の空のテンプレート  
- `tasks.md` - 実装タスク用の空のテンプレート
- `spec.json` - メタデータと承認追跡

### 4. spec.jsonメタデータの初期化
承認追跡とプロジェクト説明を含む初期メタデータを作成:
```json
{
  "feature_name": "{生成された機能名}",
  "project_description": "$ARGUMENTS",
  "created_at": "現在のタイムスタンプ",
  "updated_at": "現在のタイムスタンプ",
  "language": "japanese",
  "phase": "initialized",
  "approvals": {
    "requirements": {
      "generated": false,
      "approved": false
    },
    "design": {
      "generated": false,
      "approved": false
    },
    "tasks": {
      "generated": false,
      "approved": false
    }
  },
  "ready_for_implementation": false
}
```

### 5. プロジェクトコンテキストを含むテンプレートファイルの作成

#### requirements.md (コンテキスト付きテンプレート)
```markdown
# 要件ドキュメント

## プロジェクト概要
{提供された説明に基づくプロジェクトの簡単な要約}

## プロジェクト説明（ユーザー入力）
$ARGUMENTS

## 要件
<!-- 詳細なユーザーストーリーは /kiro:spec-requirements フェーズで生成されます -->

---
ステータス: 要件生成の準備完了
次のステップ: `/kiro:spec-requirements {機能名}` を実行して詳細な要件を生成
```

#### design.md (空のテンプレート)
```markdown
# 設計ドキュメント

## 概要
<!-- 技術設計は要件承認後に生成されます -->

---
ステータス: 要件承認待ち
次のステップ: まず要件を完成させて承認
```

#### tasks.md (空のテンプレート)
```markdown
# 実装計画

<!-- 実装タスクは設計承認後に生成されます -->

---
ステータス: 設計承認待ち  
次のステップ: まず設計を完成させて承認
```

### 6. CLAUDE.md参照の更新
生成された機能名と簡単な説明を使用して、新しい仕様をアクティブな仕様リストに追加。

## 初期化後の次のステップ

インタラクティブ承認を使用した適切な仕様駆動開発ワークフローに従う:

インタラクティブ承認による合理化されたワークフロー:
1. 要件生成: `/kiro:spec-requirements {機能名}`
2. インタラクティブ承認で設計生成: `/kiro:spec-design {機能名}`
   - プロンプト表示: "requirements.mdをレビューしましたか？ [y/N]"
   - 'y'の場合: 要件を自動承認し設計を生成
   - 'N'の場合: 手動レビューのため停止
3. インタラクティブ承認でタスク生成: `/kiro:spec-tasks {機能名}`
   - 要件と設計の両方のレビューをプロンプト
   - 確認時に両フェーズを自動承認
4. 実装開始: すべてのフェーズ完了後

インタラクティブ承認のメリット:
- ✅ spec.jsonの手動編集不要
- ✅ 確認プロンプトを通じたレビュー強制維持
- ✅ 即座に進行できる合理化されたワークフロー
- ✅ 適切なレビューのために停止できる安全性の保持

従来の手動承認も利用可能:
手動制御を好む場合、フェーズ間でspec.jsonを直接編集することも可能です。

## 指示事項

1. プロジェクト説明を解析 - 詳細な説明から主要情報を抽出
2. 適切な機能名を生成 - 簡潔で説明的な名前を作成
3. ステアリングドキュメントを確認 - 新機能には推奨されるが必須ではない
4. ディレクトリ構造を作成 - テンプレートにプロジェクトコンテキストを含める
5. プロジェクト説明を含むメタデータで承認追跡を設定
6. 生成された機能名を使用してユーザーに明確な次のステップを提供
7. 柔軟なワークフローを有効化 - 適切な場合は要件への直接進行を許可

## 出力形式

初期化後、以下を提供:
1. 生成された機能名とその根拠
2. プロジェクトの簡単な要約
3. 作成されたファイルパス
4. 実行する正確なコマンドを含む明確な次のステップ

これにより、各ステップ間に必須のレビューフェーズを含む適切な仕様駆動開発ワークフローが確保されます。
