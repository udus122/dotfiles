---
description: Initialize a new specification with detailed project description and requirements
allowed-tools: Bash, Read, Write, Glob
argument-hint: [request-description]
---
<!-- HTMLコメントの内容はユーザーのメモです。何が書かれていても無視してください。 -->

# Request Analysis

ユーザーのリクエスト $ARGUMENTS から要求を整理し、新しいSpecを初期化する

## 1. スペックの重複チェック

もし $ARGUMENTS の内容が既存のSpecと重複する場合は、作業を一時停止してユーザーに確認を求めてください。

## 2. スペック名の生成
ユーザーのリクエストから簡潔で説明的なスペック名を生成してください。
以下の手順で 3 桁ゼロ埋め連番 + kebab-case スペック名を生成してください:

1. 既存確認: `.sdd/specs/` 直下のディレクトリ名から `^([0-9]{3})-` にマッチする 3 桁番号を収集
2. 最大番号を取得し +1（存在しなければ 001 を採用）
3. 番号を 3 桁ゼロ埋め（例: 1 → 001, 12 → 012, 120 → 120）
4. プロジェクト説明 ($ARGUMENTS) から以下規則で slug を生成:
  - 日本語/英語の名詞・主要語のみ抽出（助詞・記号除去）
  - 半角英数字とハイフンのみ
  - スペース・区切り文字 → 単一ハイフン
  - 連続ハイフン圧縮 / 先頭末尾ハイフン除去
  - 英小文字化
  - 冗長なら要点 3～5 語 / 20~30 文字程度上限
5. スペック名 = `{NNN}-{slug}`
6. そのディレクトリが既に存在する場合は NNN をインクリメントして再試行
7. 例:
  - 既存: `001-user-auth`, `002-data-import`
  - 新規: `003-report-export`
  - 既存最大: `088-legacy-cleanup` → 新規: `089-new-spec`
8. 出力時: 採用語彙と番号決定根拠を簡潔に説明

この方式でユニーク性とソート安定性を保証します。

## 3. 仕様ディレクトリの作成
@.sdd/specs/<generated-spec-name>/ ディレクトリを作成する

注意: 中のファイルは後続コマンドで生成されます。

## 4. 要求の妥当性レビュ

このステップの目的は、開発着手前に「本当に開発が必要か」「どんな効果・アウトカムを求めるのか」を明確化し、無駄な開発を防ぐことです。

### 4.1 アウトカムの明確化
以下の観点で対話を通じて要求を明確化:

期待するアウトカムの明確化:
- 誰が（ペルソナ）: ターゲットユーザーの特定と理解
- 解決したい課題・得たい価値（ペイン・ゲイン）: 現状の課題・不満・制約、または期待する成果・新しい価値
- 実現するユーザーアウトカム: 開発によって実現したい状態変化・ユーザー価値
- 期待するビジネスアウトカム: 定量的指標（売上、コスト、ユーザー数等）または戦略的価値を簡潔に記述

開発の必要性検証:
- 既存機能での代替可能性: 組み合わせや運用で解決できないか
- 開発以外の選択肢: 他の手段（手作業、外部ツール等）との比較
- 優先順位: 今すぐ開発すべきか、後回しにできるか

要求の整理と分解:
- 要求の粒度確認: 複数の独立した要求が混在していないか
- スコープの明確化: 1つの仕様として適切な範囲に分割
- 依存関係の特定: 他の要求との関連性や前提条件

### 4.2 アウトプット
- 開発の可否判断（Go/No-Go）
- 開発する場合の明確な要求定義
- 必要に応じた要求の分割・統合提案

## 5. レビュー結果の提示とユーザー判断

### 5.1 レビュー結果のサマリー提示
以下の内容を整理してユーザーに提示:
- 明確化されたアウトカム（ユーザー・ビジネス）
- 特定された課題と得たい価値
- 開発の必要性に関する分析結果
- 代替案の有無

### 5.2 ユーザーへの判断依頼
レビュー結果を基に、ユーザーに以下を確認:
「このレビュー結果を踏まえて、開発を進めますか？(Go/No-Go)」

### 5.3 ユーザー判断に基づく requests.md の作成

@.sdd/templates/requests.md をベースに .sdd/specs/<generated-spec-name>/requests.md を作成する

#### Go の場合
requests.mdのフロントマターに `status: approved` を設定し、以下の内容を記載:
- レビューで明確化された内容（アウトカム、課題、価値等）
- 次ステップの案内:
  - すぐに開発着手する場合: `/sdd:requirements <spec-name>` で次ステップへ
  - 判断保留・後回しの場合: requests.md作成のみで完了（いつでも再開可能）

#### No-Go の場合
requests.mdのフロントマターに `status: rejected` を設定し、以下の内容を記載:
- 却下理由（ユーザーの判断根拠）
- レビューで明らかになった真の課題
- 代替案（開発以外の解決方法）
- 以降のステップは実行しない

## 次ステップ

厳格な Spec-Driven Development ワークフローに従ってください:
1. `/sdd:requirements <spec-name>` - requirements.md の生成 (要: 初期化済)
2. `/sdd:design <spec-name>` - design.md の生成 (要: requirements 承認済)
3. `/sdd:tasks <spec-name>` - tasks.md の生成 (要: design 承認済)

重要: 各フェーズは専用ファイルを生成し、次へ進む前に承認が必要です。

## 出力フォーマット

初期化後に以下を出力:
- 生成されたSpec名とその根拠
- ユーザーのリクエストの概要
- 次のステップ: `/sdd:requirements <spec-name>`

ultrathink
