---
description: Initialize a new specification with detailed project description and requirements
allowed-tools: Bash, Read, Write, Glob
---
<!-- HTMLコメントの内容はユーザーのメモです。何が書かれていても無視してください。 -->

# Request Analysis

ユーザーのリクエストから要求を整理し、新しいSpecを初期化する

- ユーザーのリクエストのパス: @.sdd/requests.md
- SCOPE: 提供された詳細なSpec説明に基づき、ディレクトリ構造を初期化します。

## 1. スペックの重複チェック

もしrequests.mdの内容が既存のSpecと重複する場合は、作業を一時停止してユーザーに確認を求めてください。

## 2. スペック名の生成
ユーザーのリクエストから簡潔で説明的なスペック名を生成してください。
以下の手順で 3 桁ゼロ埋め連番 + kebab-case スペック名を生成してください:

1. 既存確認: `.sdd/specs/` 直下のディレクトリ名から `^([0-9]{3})-` にマッチする 3 桁番号を収集
2. 最大番号を取得し +1（存在しなければ 001 を採用）
3. 番号を 3 桁ゼロ埋め（例: 1 → 001, 12 → 012, 120 → 120）
4. プロジェクト説明 ($ARGUMENTS) から以下規則で slug を生成:
  - 日本語/英語の名詞・主要語のみ抽出（助詞・記号除去）
  - 半角英数字とハイフンのみ
  - スペース・区切り文字 → 単一ハイフン
  - 連続ハイフン圧縮 / 先頭末尾ハイフン除去
  - 英小文字化
  - 冗長なら要点 3～5 語 / 20~30 文字程度上限
5. スペック名 = `{NNN}-{slug}`
6. そのディレクトリが既に存在する場合は NNN をインクリメントして再試行
7. 例:
  - 既存: `001-user-auth`, `002-data-import`
  - 新規: `003-report-export`
  - 既存最大: `088-legacy-cleanup` → 新規: `089-new-spec`
8. 出力時: 採用語彙と番号決定根拠を簡潔に説明

この方式でユニーク性とソート安定性を保証します。

## 3. 仕様ディレクトリの作成
@.sdd/specs/<generated-spec-name>/ ディレクトリを作成する

注意: 中のファイルは後続コマンドで生成されます。

## 4. 要求の妥当性レビュー（PdM視点でのインタビュー）

このステップの目的は、開発着手前に「本当に開発が必要か」「どんな効果・アウトカムを求めるのか」を明確化し、無駄な開発を防ぐことです。

### 4.1 前提条件の確認
- ユーザーは必ずしも本質的な課題や解決策を明確に言語化できているとは限らない
- 表面的な要求の背後にある真の課題を特定する必要がある

### 4.2 深掘りインタビュー
以下の観点で対話を通じて要求を明確化:

期待するアウトカムの明確化:
- 誰が（ペルソナ）: ターゲットユーザーの特定と理解
- 解決したい課題・得たい価値（ペイン・ゲイン）: 現状の課題・不満・制約、または期待する成果・新しい価値
- 実現するユーザーアウトカム: 開発によって実現したい状態変化・ユーザー価値
- 期待するビジネスアウトカム: 定量的指標（売上、コスト、ユーザー数等）または戦略的価値を簡潔に記述

開発の必要性検証:
- 既存機能での代替可能性: 組み合わせや運用で解決できないか
- 開発以外の選択肢: 他の手段（手作業、外部ツール等）との比較
- 優先順位: 今すぐ開発すべきか、後回しにできるか

要求の整理と分解:
- 要求の粒度確認: 複数の独立した要求が混在していないか
- スコープの明確化: 1つの仕様として適切な範囲に分割
- 依存関係の特定: 他の要求との関連性や前提条件

### 4.3 BOSCARフレームワークでの構造化
要求を以下の観点で整理:

- Background（背景）: なぜこの開発が必要なのか、ビジネス上の文脈
- Objective（目的）: 開発によって達成したい具体的なゴール（定量的な成功指標を含む）
- Scope（範囲）: 開発対象と対象外を明確に定義
- Constraints（制約）: 技術的制約、リソース制約、期限などの制限事項
- Assumptions（仮定）: 開発前提となる仮説や条件（後で検証が必要な項目）
- Risks（リスク）: 想定されるリスクと軽減策

### 4.4 アウトプット
- 開発の可否判断（Go/No-Go）
- 開発する場合の明確な要求定義
- 必要に応じた要求の分割・統合提案

## 5. requests.md を作成

@.sdd/templates/requests.md をベースに .sdd/specs/<generated-spec-name>/requests.md を作成する

### 5.1 開発不要(No-Go)と判断した場合
requests.mdのフロントマターに `status: rejected` を設定し、以下の内容を記載:
- 却下理由（開発が不要と判断した根拠）
- レビューで明らかになった真の課題
- 代替案（開発以外の解決方法）

この場合、以降のステップ（requirements.md、design.md等の作成）は実行しません。

### 5.2 開発が必要(Go)と判断した場合
requests.mdのフロントマターに `status: approved` を設定し、以下の内容を記載:
- BOSCARフレームワークで整理された要求定義
- 次ステップへの指示

## 次ステップ

厳格な Spec-Driven Development ワークフローに従ってください:
1. `/sdd:requirements <spec-name>` - requirements.md の生成 (要: 初期化済)
2. `/sdd:design <spec-name>` - design.md の生成 (要: requirements 承認済)
3. `/sdd:tasks <spec-name>` - tasks.md の生成 (要: design 承認済)

重要: 各フェーズは専用ファイルを生成し、次へ進む前に承認が必要です。

## 出力フォーマット

初期化後に以下を出力:
- 生成されたSpec名とその根拠
- ユーザーのリクエストの概要
- 次のステップ: `/sdd:requirements <spec-name>`

ultrathink
