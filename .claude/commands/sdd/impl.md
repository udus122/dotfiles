---
description: Specからタスクを実行する
allowed-tools: Read, Write, Edit, MultiEdit, Glob, Grep
argument-hint: [spec-name] [task-number] [-y]
---

# Implement Spec

Spec $1 を実装する

## 1 前提条件の確認

### 1.1 タスク計画の承認状態を確認

スペックを実装する前提となるタスク計画を確認する

- `-y`付きで呼び出された場合（$3 == "-y"）、 フロントマターの`status`を`status: approved`に設定
  - パス: @.sdd/specs/$1/tasks.md
- そうでない場合: 未承認(`status != approved`)の場合、メッセージで停止:
  - 「タスク計画が未承認です。`/sdd:tasks`を実行するか、`-y`フラグを使用して自動承認してください」

### 1.2 読み込むファイルパスの確認

実装に必要なファイルのパスを確認:

Steeringファイル:
- 製品コンテキストとビジネス目標: @.sdd/steering/product.md
- 技術スタックとアーキテクチャ決定: @.sdd/steering/tech.md
- ファイル構成とコードパターン: @.sdd/steering/structure.md
- カスタムステアリングファイル: @.sdd/steering/ 配下のその他ドキュメント

Specファイル:
- 要求(実現したいアウトカム): @.sdd/specs/$1/requests.md
- 要件(ユーザーストーリーと受入基準): @.sdd/specs/$1/requirements.md
- 設計(Design Doc): @.sdd/specs/$1/design.md
- タスク実行計画: @.sdd/specs/$1/tasks.md

## 2 Steeringコンテキストの読み込み

1.2で確認したSteeringファイルの内容を読み込みます:
- product.md: 製品の目的とビジネス目標を理解
- tech.md: 使用する技術スタックとアーキテクチャ決定を把握
- structure.md: ファイル構成と命名規則、コードパターンを確認
- その他カスタムファイル: プロジェクト固有のガイドラインを参照

## 3 Specコンテキストの読み込み

1.2で確認したSpecファイルの内容を読み込みます:
- requests.md: 実現したいアウトカムとユーザー価値を理解
- requirements.md: 具体的な要件とREQ-IDを確認
- design.md: 技術設計とアーキテクチャを把握
- tasks.md: 実行するタスクの詳細を確認

## 4 タスクの実行

### 4.1 実行対象の特定

- Spec名: $1（必須）
- タスク番号: $2（任意、未指定の場合は最初のメインタスクを実行）
  - 未指定: 最初のメインタスク（例: `1`とそのサブタスク）を実行
  - `all`: すべての未完了タスクを実行
  - 単一タスク: `1.1`
  - 複数タスク: `1.1,1.2,2.1`
  - メインタスク: `1` (サブタスク1.1, 1.2...をすべて実行)

### 4.2 タスクの実装

2-3で読み込んだコンテキスト（Steering + Spec）に基づいて、指定されたタスクを実装します：

1. 1.2で確認したtasks.mdから該当タスクの詳細を確認
2. 1.2で確認したrequirements.mdの対応要件（REQ-ID）を参照
3. 1.2で確認したdesign.mdの設計に従って実装
4. タスク詳細の項目を順次実行
5. 実装完了後、該当タスクのチェックボックスを`- [x]`に更新

## 5 タスク完了後の後処理

すべてのタスクが完了したら、以下を実施します：

- tasks.md のチェックボックスを未完了(`- [ ]`)完了済み(`- [x]`)に更新します。
- テスト・Lint がすべて成功しているか確認
- 必要なドキュメントやコメントを更新
- 未解決のタスクが残った場合は、その理由と次のアクションを tasks.md に記載し、必ず後続の実装で解消できるよう記録します。
- @.sdd/specs/$1/impl.md にタスクレポートを記載する
  - 作業の概要報告
  - 実行中のタスクについて
  - 実装中に発見した未解決の課題
  - プロダクトのブラッシュアップ案
